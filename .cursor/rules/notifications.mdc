---
alwaysApply: true
---

# Notifications & Reminders Rules

## Purpose

Implement a **configurable notification system** that nudges users without being obnoxious.

Initial focus is **web-only**:

- Use the browser Notification API when permitted.
- Fall back to in-app banners/toasts when notifications are blocked or unavailable.

## Design

Abstract notifications in `src/services/notifications`:

- `requestPermission(): Promise<NotificationPermission>`
- `scheduleDailyReminder(timeOfDay, payload)`
- `cancelDailyReminder(id)`
- `showImmediateNotification(payload)`

Implementation:

- For now:
  - Browser Notification API + `setTimeout` / scheduling logic while the app is open.
  - Future: integration with a backend or service worker for more reliable schedules if needed.

## Notification Types

- Daily “Today’s plan” reminder.
- “You are X days behind” alert.
- “You’re ahead of schedule—want to tighten your deadline or ramp up?” prompts.
- Optional “Weekly review” reminder.

All must be:

- Toggleable in Settings.
- Respect user/broswer permissions.

## Scheduling Rules

- Daily reminder:
  - Use user-configured local time.
  - When app is open, show Notification or in-app banner around that time.
- Behind schedule alerts:
  - Trigger only when crossing thresholds (e.g., 1, 3, 7 days behind).
- Ahead-of-schedule alerts:
  - Trigger when ahead by a defined threshold.

## Cursor Guidance

- Do not assume notifications are available; always check permissions.
- Gracefully fall back:
  - If browser notifications are disabled, show inline UI (e.g., banner at top).
- Keep notification logic decoupled from React components:
  - Components call service functions.
  - Services handle Notification API and scheduling.
